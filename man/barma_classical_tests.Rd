% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/barma_classical_tests.R
\name{barma_classical_tests}
\alias{barma_classical_tests}
\title{Classical Hypothesis Tests in \eqn{\beta}ARMA Models}
\usage{
barma_classical_tests(
  y,
  ar = NA,
  ma = NA,
  link = "logit",
  rest_ar = NA,
  rest_ma = NA,
  arma_only = FALSE
)
}
\arguments{
\item{y}{A time series object of class \code{ts}. Values must be strictly within
the interval (0, 1).}

\item{ar}{(Optional) A scalar or vector specifying the autoregressive (AR)
orders for the unrestricted model.
Example: \code{1} for AR(1), \code{c(1,3)} for AR with lags 1 and 3.
Use \code{NA} if no AR component is desired.}

\item{ma}{(Optional) A scalar or vector specifying the moving average (MA)
orders for the unrestricted model.
Example: \code{1} for MA(1), \code{c(1,2)} for MA with lags 1 and 2.
Use \code{NA} if no MA component is desired.}

\item{link}{A string specifying the link function for the conditional mean.
Supported: \code{"logit"} (default), \code{"probit"},\code{"cloglog"},\code{"loglog"}.}

\item{rest_ar}{A scalar or vector indicating specific AR lags
(from \code{ar} of unrestricted model) to restrict to zero
under the null hypothesis.
Example: If \code{ar = c(1,2)} and \code{rest_ar = 2}, tests
H0: \eqn{\varphi_2 = 0}.
If \code{rest_ar = c(1,2)}, tests H0: \eqn{\varphi_1=\varphi_2 = 0}.
Defaults to \code{NA}.}

\item{rest_ma}{A scalar or vector indicating specific MA lags
(from \code{ma} of unrestricted model) to restrict to zero
under the null hypothesis. Similar to \code{rest_ar}.
Defaults to \code{NA}.
Note: Typically, either \code{rest_ar} OR \code{rest_ma} is specified.}

\item{arma_only}{A logical value (boolean).
If \code{FALSE} (default): Performs full procedure: estimates
unrestricted and restricted models, computes all tests.
If \code{TRUE}: Primarily performs optimization for the specified
BARMA(p,q) model (unrestricted_model output) and SKIPS tests.
Other model/test outputs (e.g., \code{tests},
\code{ar_restricted_model}, \code{ma_restricted_model}) will be \code{NULL}
or minimal.}
}
\value{
A list object with the following named elements:
\describe{
\item{\code{unrestricted_model}}{Object (list) with detailed results from
fitting the full BARMA(p,q) model. Includes
estimates (\code{coeff}), SEs, log-likelihood
(\code{loglik}), convergence status (\code{conv}),
vcov matrix (\code{arma_vcov}).}
\item{\code{ar_restricted_model}}{Object (list) with results from fitting a
BARMA model where AR components (specified by
\code{rest_ar} or all AR) are restricted to zero.
Estimated if AR restrictions are tested. May
be \code{NULL}.}
\item{\code{ma_restricted_model}}{Object (list) with results from fitting a
BARMA model where MA components (specified by
\code{rest_ma} or all MA) are restricted to zero.
Estimated if MA restrictions are tested. May
be \code{NULL}.}
\item{\code{tests}}{A list with Wald, Likelihood Ratio (LR), and Rao Score
(RS) test results. Populated if \code{arma_only = FALSE} and
models converge. Sub-elements refer to different
formulations, some addressing issues from Costa et al. (2024)
regarding the number of terms in log-likelihood
(\code{a = max(p,q)}).
\itemize{
\item \code{W_res}: Wald test (stat, p-val). \code{W1} in Costa et
al. (2024), uses info matrix from unrestricted
model.
\item \code{W2_res}: Alt. Wald test (stat, p-val). \code{W2} in
Costa et al. (2024), uses info matrix from
restricted model estimated with equal likelihood
terms (\code{mat_vcov_mfun}).
\item \code{LR_naive_res}: "Naive" LR test (stat, p-val,
loglik_restr). \code{LR1} in Costa et al. (2024).
Uses \code{loglik_restr_naive} from restricted
model estimated with its own \code{a_N}. Can be
inaccurate or negative if \code{a_N < a_NN}.
\item \code{LR_m0_res}: LR test (stat, p-val, loglik_restr
\code{loglik_restr_m0}). \code{LR2} from Costa
et al. (2024) if \code{loglik_restr_m0} is an
adjusted sum.
\item \code{LR_mfun_res}: Recommended LR test (stat, p-val,
loglik_restr \code{loglik_restr_mfun}). \code{LR3} in
Costa et al. (2024). \code{loglik_restr_mfun}
from restricted model using \code{a_NN} (from
unrestricted model) for equal terms in
log-likelihoods. Non-negative.
\item \code{R_naive_res}: "Naive" Rao Score (reduced form)
(stat, p-val). \verb{Sr*} in Costa et al. (2024).
Uses \code{score_vec_naive}, \code{mat_vcov_naive}
from restricted model with its own \code{a_N}.
\item \code{R_expanded_res}: "Naive" Rao Score (extended)
(stat, p-val). \verb{Se*} in Costa et al.
(2024). Uses \code{score_vec_naive},
\code{mat_vcov_naive} from restricted model
with its own \code{a_N}.
\item \code{R_mfun_res}: Recommended Score (reduced) (stat,
p-val). \code{Sr} in Costa et al. (2024). Uses
\code{score_vec_mfun}, \code{mat_vcov_mfun} from
restricted model using \code{a_NN}.
\item \code{R_exp_mfun_res}: Recommended Score (extended)
(stat, p-val). \code{Se} in Costa et al.
(2024). Uses \code{score_vec_mfun},
\code{mat_vcov_mfun} from restricted model
using \code{a_NN}.
}
(Each result typically includes test statistic and p-value.
DF for chi-squared tests is \code{num_rest}).
}
}
}
\description{
This R function, \code{barma_classical_tests}, performs a suite of classical
hypothesis tests -- Wald(W), Likelihood Ratio (LR), and Rao Score (RS) --
for Beta Autoregressive Moving Average (\eqn{\beta}ARMA) models. These
models are particularly useful for doubly-bounded time series, such as
those found in hydro-environmental studies (e.g., reservoir useful
volumes), which may exhibit seasonality and be subject to abnormal
regimes like prolonged droughts.

The function is derived from an original BARMA implementation by Fabio M.
Bayer and has been significantly refactored and extended by Everton da Costa.
}
\details{
Key features and considerations based on recent research:
\itemize{
\item Code structuring adhering to the tidyverse style guide for improved
readability and maintainability.
\item Implementation validated against the foundational paper:
Rocha, A.V.; Cribari-Neto, F. (2009). Beta autoregressive moving
average models. TEST, 18(3), 529--545. (Erratum: TEST, 26, 2017,
451--459).
\item This function implements the classical hypothesis tests presented in the
study: Costa, E.; Cribari-Neto, F.; Scher, V.T. (2024). Test inferences
and link function selection in dynamic beta modeling of seasonal
hydro-environmental time series with temporary abnormal regimes.
Journal of Hydrology, 638, 131489.
The study highlights potential inaccuracies in standard LR and Score tests
when the number of individual conditional log-likelihoods differs
between the null and non-null (unrestricted) models. This issue arises
when autoregressive (p) or moving average (q) orders change, affecting
\code{a = max(p,q)}. To address this, the function provides several test
variants, including the recommended \code{LR_mfun_res}, \code{R_mfun_res}, and
\code{R_exp_mfun_res}, which ensure comparability and lead to more accurate
inferences.
\item Optimization of the likelihood estimation process using the L-BFGS
algorithm via the \code{lbfgs} package. (Ensure \code{lbfgs} is listed in
Imports in DESCRIPTION if this is a package).
\item Improved computational efficiency by minimizing redundant calculations.
\item Comprehensive implementation of Wald, Likelihood Ratio, and Rao Score
tests, including several variations, to assess parameter
restrictions (e.g., significance of AR or MA components).
}
}
\section{Authorship and Version}{

\itemize{
\item Based on the original code by: Fabio M. Bayer (bayer@ufsm.br),
Date: 2015-10-15
\item Modified and improved by: Everton da Costa (everto.cost@gmail.com),
Date: 2022-02-03
\item VERSION: 1.00
\item LAST UPDATE: 2023-07-27
}
}

\examples{
\dontrun{
# Assuming 'y' is a time series object (ts) with values in (0,1)
# Example: Test significance of AR(1) and MA(1) components
# in a BARMA(1,1) model.

# To test AR components (H0: varphi_1 = 0)
# Note: This requires the actual barma_classical_tests function and its
# dependencies to be available and working.
# results_test_ar <- barma_classical_tests(y = y, ar = 1, ma = 1,
#                                        link = "logit", rest_ar = 1)
# print(results_test_ar$tests)

# To test MA components (H0: theta_1 = 0)
# results_test_ma <- barma_classical_tests(y = y, ar = 1, ma = 1,
#                                        link = "logit", rest_ma = 1)
# print(results_test_ma$tests)

# To estimate model without running specific tests (if arma_only = TRUE)
# model_only <- barma_classical_tests(y = y, ar = 1, ma = 1,
#                                   link = "logit", arma_only = TRUE)
# print(model_only$unrestricted_model)
}

}
\references{
\insertRef{costa_cribari_scher_2024}{BARMAJournalHydrology2024}

\insertRef{rocha_cribari_neto_2009}{BARMAJournalHydrology2024}
}
\seealso{
To get the formal citation for this package, run:
\code{citation("BARMAJournalHydrology2024")}.
}
\keyword{models}
\keyword{regression}
\keyword{ts}
