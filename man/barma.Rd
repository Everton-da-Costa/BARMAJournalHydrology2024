% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/barma.R
\name{barma}
\alias{barma}
\title{Beta Autoregressive Moving Average (\eqn{\beta}ARMA) Model Estimation}
\usage{
barma(y, ar = NA, ma = NA, link = "logit", h1 = 12, X = NA, X_hat = NA)
}
\arguments{
\item{y}{A `ts` object with values in (0,1).}

\item{ar}{Numeric vector of AR lags (e.g., `c(1,2)`). Default: `NA` (no AR).}

\item{ma}{Numeric vector of MA lags (e.g., `c(1)`). Default: `NA` (no MA).}

\item{link}{Link function: "logit" (default), "probit", "cloglog", "loglog".
Connects mean \eqn{\mu_t \in (0,1)} to linear predictor
\eqn{\eta_t}.}

\item{h1}{Integer, forecast horizon. Default: 12.}

\item{X}{Optional. Numeric matrix or `ts` of exogenous regressors.
Rows must match `length(y)`. Default: `NA`.}

\item{X_hat}{Optional. Future values for `X` if `h1 > 0`. Must have `h1` rows.
Default: `NA`.}
}
\value{
A list containing:
\item{coef}{Named vector of estimated parameters
(\eqn{\alpha, \varphi, \theta, \phi, \beta}).}
\item{vcov}{Variance-covariance matrix of estimates.}
\item{loglik}{Maximized conditional log-likelihood.}
\item{aic, bic, hq}{Information criteria (AIC, BIC, Hannan-Quinn).}
\item{model}{Summary table: estimates, std. errors, z-values, p-values.}
\item{fitted}{`ts` object of fitted mean values \eqn{\hat{\mu}_t}.}
\item{forecast}{Vector of `h1` point forecasts for \eqn{y_t} if `h1 > 0`.}
\item{resid2}{Standardized residuals on the predictor scale.}
\item{link}{Link function used.}
\item{n_obs}{Number of observations in `y`.}
\item{phi, alpha, varphi, theta, beta}{Individual estimated parameters.}
\item{etahat, muhat, errorhat}{Estimated predictors, means, and
predictor-scale errors.}
\item{fisher_info_mat}{Observed Fisher Information Matrix.}
\item{start_values}{Initial parameters for optimization.}
\item{conv}{Convergence code from `lbfgs` (0 = success).}
\item{inv_inf_matrix}{Indicator for Fisher matrix invertibility (0 = success).}
\item{opt (`opt_arma`, etc.)}{Raw `lbfgs` optimization output.}
}
\description{
Fits \eqn{\beta}ARMA, \eqn{\beta}AR, \eqn{\beta}MA, \eqn{\beta}ARMAX,
\eqn{\beta}ARX, or \eqn{\beta}MAX models for time series data
in (0,1) using conditional maximum likelihood (errors on predictor scale).
}
\details{
The `barma` function models time series `y` (values in (0,1)) like rates or
proportions. It uses the L-BFGS algorithm for optimization via the `lbfgs`
package.

Model specification depends on `ar`, `ma`, and `X` (exogenous regressors):
\itemize{
  \item BARMA(p,q): `ar`, `ma` given.
  \item BAR(p): `ar` given, `ma` is `NA`.
  \item BMA(q): `ma` given, `ar` is `NA`.
  \item BARMAX(p,q,k): `ar`, `ma`, `X` (k regressors) given.
  \item BARX(p,k): `ar`, `X` given, `ma` is `NA`.
  \item BMAX(q,k): `ma`, `X` given, `ar` is `NA`.
}
\eqn{g(\mu_t)} is the link function applied to the mean \eqn{\mu_t}.
\eqn{\epsilon_t = g(y_t) - g(\mu_t)} are predictor-scale errors.
If `X` is used, `ar` or `ma` must also be specified.
Forecasts assume future predictor-scale errors are zero.

\strong{Key Enhancements in this Implementation:}
This version incorporates several improvements over earlier iterations,
including (but not restricted to):
\itemize{
  \item Code refactoring following the tidyverse style guide for clarity.
  \item Rigorous validation of the implementation against the original
    methodology by Rocha & Cribari-Neto (2009, 2017).
  \item Adoption of the L-BFGS optimization algorithm (via the `lbfgs`
    package) for robust and efficient parameter estimation.
  \item Enhanced computational efficiency through the avoidance of
    redundant calculations within the estimation routines.
}
}
\examples{
\dontrun{
Placeholder data for demonstration
set.seed(1983)
y_ts <- simu_barma(
  n = 250, alpha = 0.0, varphi = 0.4,
  theta = c(0.24, -0.12), phi = 20, freq = 12, link = "logit"
)

# Fit a BARMA(1,2) model
if (requireNamespace("lbfgs", quietly = TRUE)) {
  fit <- barma(y = y_ts, ar = 1, ma = 1:2, link = "logit", h1 = 10)
  if (!is.null(fit$model)) print(fit$model)
}
}

}
\references{
\insertRef{costa_cribari_scher_2024}{BARMAJournalHydrology2024}

\insertRef{rocha_cribari_neto_2009}{BARMAJournalHydrology2024}
}
\seealso{
To get the formal citation for this package, run:
`citation("BARMAJournalHydrology2024")`.

\code{\link[stats]{make.link}}, \code{\link[lbfgs]{lbfgs}}
}
\keyword{ARMA}
\keyword{BARMA}
\keyword{beta}
\keyword{regression}
\keyword{timeseries}
